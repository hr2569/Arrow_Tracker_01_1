{"dependencies":[{"name":"./fileSystemCompat","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"ldhJfOaVe5Io4bY1AY/gSUBzcds=","exportNames":["*"],"imports":1}},{"name":"expo-sharing","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":106},"end":{"line":3,"column":40,"index":146}}],"key":"SUh687CeWkW0B+T6RbmrU/yQMvg=","exportNames":["*"],"imports":1}},{"name":"expo-document-picker","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":147},"end":{"line":4,"column":55,"index":202}}],"key":"NWjULt4J8GGUdXN68lY2F08+J7M=","exportNames":["*"],"imports":1}},{"name":"./localStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":203},"end":{"line":5,"column":79,"index":282}}],"key":"0SgXd320WtDFl1YmvtLMkksOAwg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"createBackup\", {\n    enumerable: true,\n    get: function () {\n      return createBackup;\n    }\n  });\n  Object.defineProperty(exports, \"restoreBackup\", {\n    enumerable: true,\n    get: function () {\n      return restoreBackup;\n    }\n  });\n  var _fileSystemCompat = require(_dependencyMap[0], \"./fileSystemCompat\");\n  var FileSystem = _interopNamespace(_fileSystemCompat);\n  var _expoSharing = require(_dependencyMap[1], \"expo-sharing\");\n  var Sharing = _interopNamespace(_expoSharing);\n  var _expoDocumentPicker = require(_dependencyMap[2], \"expo-document-picker\");\n  var DocumentPicker = _interopNamespace(_expoDocumentPicker);\n  var _localStorage = require(_dependencyMap[3], \"./localStorage\");\n  /**\n   * Creates a backup of all data and opens the native share sheet\n   * User can save to Google Drive, email, or any other app\n   */\n  const createBackup = async () => {\n    try {\n      // Get all data from local storage\n      const data = await (0, _localStorage.getAllData)();\n\n      // Create backup object\n      const backup = {\n        version: '1.0',\n        exportedAt: new Date().toISOString(),\n        appName: 'Arrow Tracker',\n        data: {\n          sessions: data.sessions,\n          bows: data.bows\n        }\n      };\n\n      // Create file name with date\n      const dateStr = new Date().toISOString().split('T')[0];\n      const fileName = `arrow-tracker-backup-${dateStr}.json`;\n      const filePath = `${FileSystem.cacheDirectory}${fileName}`;\n\n      // Write to file\n      await FileSystem.writeAsStringAsync(filePath, JSON.stringify(backup, null, 2));\n\n      // Check if sharing is available\n      const sharingAvailable = await Sharing.isAvailableAsync();\n      if (!sharingAvailable) {\n        return {\n          success: false,\n          error: 'Sharing is not available on this device'\n        };\n      }\n\n      // Open native share sheet\n      await Sharing.shareAsync(filePath, {\n        mimeType: 'application/json',\n        dialogTitle: 'Save Arrow Tracker Backup',\n        UTI: 'public.json'\n      });\n\n      // Update last backup date\n      await (0, _localStorage.setLastBackupDate)();\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Backup error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      };\n    }\n  };\n\n  /**\n   * Opens file picker to select a backup file and restores the data\n   */\n  const restoreBackup = async () => {\n    try {\n      // Open file picker\n      const result = await DocumentPicker.getDocumentAsync({\n        type: 'application/json',\n        copyToCacheDirectory: true\n      });\n\n      // Check if user cancelled\n      if (result.canceled) {\n        return {\n          success: false,\n          canceled: true\n        };\n      }\n      const file = result.assets[0];\n\n      // Read file content\n      const content = await FileSystem.readAsStringAsync(file.uri);\n      const backup = JSON.parse(content);\n\n      // Validate backup format\n      if (!backup.data || !backup.data.sessions && !backup.data.bows) {\n        return {\n          success: false,\n          error: 'Invalid backup file format'\n        };\n      }\n\n      // Restore data\n      const restored = await (0, _localStorage.restoreAllData)({\n        sessions: backup.data.sessions || [],\n        bows: backup.data.bows || []\n      });\n      if (!restored) {\n        return {\n          success: false,\n          error: 'Failed to restore data'\n        };\n      }\n      return {\n        success: true,\n        sessionsCount: backup.data.sessions?.length || 0,\n        bowsCount: backup.data.bows?.length || 0\n      };\n    } catch (error) {\n      console.error('Restore error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      };\n    }\n  };\n});","lineCount":155,"map":[[22,2,11,0,"Object"],[22,8,11,0],[22,9,11,0,"defineProperty"],[22,23,11,0],[22,24,11,0,"exports"],[22,31,11,0],[23,4,11,0,"enumerable"],[23,14,11,0],[24,4,11,0,"get"],[24,7,11,0],[24,18,11,0,"get"],[24,19,11,0],[25,6,11,0],[25,13,11,0,"createBackup"],[25,25,11,0],[26,4,11,0],[27,2,11,0],[28,2,61,0,"Object"],[28,8,61,0],[28,9,61,0,"defineProperty"],[28,23,61,0],[28,24,61,0,"exports"],[28,31,61,0],[29,4,61,0,"enumerable"],[29,14,61,0],[30,4,61,0,"get"],[30,7,61,0],[30,18,61,0,"get"],[30,19,61,0],[31,6,61,0],[31,13,61,0,"restoreBackup"],[31,26,61,0],[32,4,61,0],[33,2,61,0],[34,2,1,0],[34,6,1,0,"_fileSystemCompat"],[34,23,1,0],[34,26,1,0,"require"],[34,33,1,0],[34,34,1,0,"_dependencyMap"],[34,48,1,0],[35,2,1,0],[35,6,1,0,"FileSystem"],[35,16,1,0],[35,19,1,0,"_interopNamespace"],[35,36,1,0],[35,37,1,0,"_fileSystemCompat"],[35,54,1,0],[36,2,3,0],[36,6,3,0,"_expoSharing"],[36,18,3,0],[36,21,3,0,"require"],[36,28,3,0],[36,29,3,0,"_dependencyMap"],[36,43,3,0],[37,2,3,0],[37,6,3,0,"Sharing"],[37,13,3,0],[37,16,3,0,"_interopNamespace"],[37,33,3,0],[37,34,3,0,"_expoSharing"],[37,46,3,0],[38,2,4,0],[38,6,4,0,"_expoDocumentPicker"],[38,25,4,0],[38,28,4,0,"require"],[38,35,4,0],[38,36,4,0,"_dependencyMap"],[38,50,4,0],[39,2,4,0],[39,6,4,0,"DocumentPicker"],[39,20,4,0],[39,23,4,0,"_interopNamespace"],[39,40,4,0],[39,41,4,0,"_expoDocumentPicker"],[39,60,4,0],[40,2,5,0],[40,6,5,0,"_localStorage"],[40,19,5,0],[40,22,5,0,"require"],[40,29,5,0],[40,30,5,0,"_dependencyMap"],[40,44,5,0],[41,2,7,0],[42,0,8,0],[43,0,9,0],[44,0,10,0],[45,2,11,7],[45,8,11,13,"createBackup"],[45,20,11,25],[45,23,11,28],[45,29,11,28,"createBackup"],[45,30,11,28],[45,35,11,87],[46,4,12,2],[46,8,12,6],[47,6,13,4],[48,6,14,4],[48,12,14,10,"data"],[48,16,14,14],[48,19,14,17],[48,25,14,23],[48,29,14,23,"getAllData"],[48,42,14,33],[48,43,14,33,"getAllData"],[48,53,14,33],[48,55,14,34],[48,56,14,35],[50,6,16,4],[51,6,17,4],[51,12,17,10,"backup"],[51,18,17,16],[51,21,17,19],[52,8,18,6,"version"],[52,15,18,13],[52,17,18,15],[52,22,18,20],[53,8,19,6,"exportedAt"],[53,18,19,16],[53,20,19,18],[53,24,19,22,"Date"],[53,28,19,26],[53,29,19,27],[53,30,19,28],[53,31,19,29,"toISOString"],[53,42,19,40],[53,43,19,41],[53,44,19,42],[54,8,20,6,"appName"],[54,15,20,13],[54,17,20,15],[54,32,20,30],[55,8,21,6,"data"],[55,12,21,10],[55,14,21,12],[56,10,22,8,"sessions"],[56,18,22,16],[56,20,22,18,"data"],[56,24,22,22],[56,25,22,23,"sessions"],[56,33,22,31],[57,10,23,8,"bows"],[57,14,23,12],[57,16,23,14,"data"],[57,20,23,18],[57,21,23,19,"bows"],[58,8,24,6],[59,6,25,4],[59,7,25,5],[61,6,27,4],[62,6,28,4],[62,12,28,10,"dateStr"],[62,19,28,17],[62,22,28,20],[62,26,28,24,"Date"],[62,30,28,28],[62,31,28,29],[62,32,28,30],[62,33,28,31,"toISOString"],[62,44,28,42],[62,45,28,43],[62,46,28,44],[62,47,28,45,"split"],[62,52,28,50],[62,53,28,51],[62,56,28,54],[62,57,28,55],[62,58,28,56],[62,59,28,57],[62,60,28,58],[63,6,29,4],[63,12,29,10,"fileName"],[63,20,29,18],[63,23,29,21],[63,47,29,45,"dateStr"],[63,54,29,52],[63,61,29,59],[64,6,30,4],[64,12,30,10,"filePath"],[64,20,30,18],[64,23,30,21],[64,26,30,24,"FileSystem"],[64,36,30,34],[64,37,30,35,"cacheDirectory"],[64,51,30,49],[64,54,30,52,"fileName"],[64,62,30,60],[64,64,30,62],[66,6,32,4],[67,6,33,4],[67,12,33,10,"FileSystem"],[67,22,33,20],[67,23,33,21,"writeAsStringAsync"],[67,41,33,39],[67,42,33,40,"filePath"],[67,50,33,48],[67,52,33,50,"JSON"],[67,56,33,54],[67,57,33,55,"stringify"],[67,66,33,64],[67,67,33,65,"backup"],[67,73,33,71],[67,75,33,73],[67,79,33,77],[67,81,33,79],[67,82,33,80],[67,83,33,81],[67,84,33,82],[69,6,35,4],[70,6,36,4],[70,12,36,10,"sharingAvailable"],[70,28,36,26],[70,31,36,29],[70,37,36,35,"Sharing"],[70,44,36,42],[70,45,36,43,"isAvailableAsync"],[70,61,36,59],[70,62,36,60],[70,63,36,61],[71,6,37,4],[71,10,37,8],[71,11,37,9,"sharingAvailable"],[71,27,37,25],[71,29,37,27],[72,8,38,6],[72,15,38,13],[73,10,38,15,"success"],[73,17,38,22],[73,19,38,24],[73,24,38,29],[74,10,38,31,"error"],[74,15,38,36],[74,17,38,38],[75,8,38,80],[75,9,38,81],[76,6,39,4],[78,6,41,4],[79,6,42,4],[79,12,42,10,"Sharing"],[79,19,42,17],[79,20,42,18,"shareAsync"],[79,30,42,28],[79,31,42,29,"filePath"],[79,39,42,37],[79,41,42,39],[80,8,43,6,"mimeType"],[80,16,43,14],[80,18,43,16],[80,36,43,34],[81,8,44,6,"dialogTitle"],[81,19,44,17],[81,21,44,19],[81,48,44,46],[82,8,45,6,"UTI"],[82,11,45,9],[82,13,45,11],[83,6,46,4],[83,7,46,5],[83,8,46,6],[85,6,48,4],[86,6,49,4],[86,12,49,10],[86,16,49,10,"setLastBackupDate"],[86,29,49,27],[86,30,49,27,"setLastBackupDate"],[86,47,49,27],[86,49,49,28],[86,50,49,29],[87,6,51,4],[87,13,51,11],[88,8,51,13,"success"],[88,15,51,20],[88,17,51,22],[89,6,51,27],[89,7,51,28],[90,4,52,2],[90,5,52,3],[90,6,52,4],[90,13,52,11,"error"],[90,18,52,16],[90,20,52,18],[91,6,53,4,"console"],[91,13,53,11],[91,14,53,12,"error"],[91,19,53,17],[91,20,53,18],[91,35,53,33],[91,37,53,35,"error"],[91,42,53,40],[91,43,53,41],[92,6,54,4],[92,13,54,11],[93,8,54,13,"success"],[93,15,54,20],[93,17,54,22],[93,22,54,27],[94,8,54,29,"error"],[94,13,54,34],[94,15,54,36,"error"],[94,20,54,41],[94,32,54,53,"Error"],[94,37,54,58],[94,40,54,61,"error"],[94,45,54,66],[94,46,54,67,"message"],[94,53,54,74],[94,56,54,77],[95,6,54,93],[95,7,54,94],[96,4,55,2],[97,2,56,0],[97,3,56,1],[99,2,58,0],[100,0,59,0],[101,0,60,0],[102,2,61,7],[102,8,61,13,"restoreBackup"],[102,21,61,26],[102,24,61,29],[102,30,61,29,"restoreBackup"],[102,31,61,29],[102,36,67,6],[103,4,68,2],[103,8,68,6],[104,6,69,4],[105,6,70,4],[105,12,70,10,"result"],[105,18,70,16],[105,21,70,19],[105,27,70,25,"DocumentPicker"],[105,41,70,39],[105,42,70,40,"getDocumentAsync"],[105,58,70,56],[105,59,70,57],[106,8,71,6,"type"],[106,12,71,10],[106,14,71,12],[106,32,71,30],[107,8,72,6,"copyToCacheDirectory"],[107,28,72,26],[107,30,72,28],[108,6,73,4],[108,7,73,5],[108,8,73,6],[110,6,75,4],[111,6,76,4],[111,10,76,8,"result"],[111,16,76,14],[111,17,76,15,"canceled"],[111,25,76,23],[111,27,76,25],[112,8,77,6],[112,15,77,13],[113,10,77,15,"success"],[113,17,77,22],[113,19,77,24],[113,24,77,29],[114,10,77,31,"canceled"],[114,18,77,39],[114,20,77,41],[115,8,77,46],[115,9,77,47],[116,6,78,4],[117,6,80,4],[117,12,80,10,"file"],[117,16,80,14],[117,19,80,17,"result"],[117,25,80,23],[117,26,80,24,"assets"],[117,32,80,30],[117,33,80,31],[117,34,80,32],[117,35,80,33],[119,6,82,4],[120,6,83,4],[120,12,83,10,"content"],[120,19,83,17],[120,22,83,20],[120,28,83,26,"FileSystem"],[120,38,83,36],[120,39,83,37,"readAsStringAsync"],[120,56,83,54],[120,57,83,55,"file"],[120,61,83,59],[120,62,83,60,"uri"],[120,65,83,63],[120,66,83,64],[121,6,84,4],[121,12,84,10,"backup"],[121,18,84,16],[121,21,84,19,"JSON"],[121,25,84,23],[121,26,84,24,"parse"],[121,31,84,29],[121,32,84,30,"content"],[121,39,84,37],[121,40,84,38],[123,6,86,4],[124,6,87,4],[124,10,87,8],[124,11,87,9,"backup"],[124,17,87,15],[124,18,87,16,"data"],[124,22,87,20],[124,26,87,25],[124,27,87,26,"backup"],[124,33,87,32],[124,34,87,33,"data"],[124,38,87,37],[124,39,87,38,"sessions"],[124,47,87,46],[124,51,87,50],[124,52,87,51,"backup"],[124,58,87,57],[124,59,87,58,"data"],[124,63,87,62],[124,64,87,63,"bows"],[124,68,87,68],[124,70,87,70],[125,8,88,6],[125,15,88,13],[126,10,88,15,"success"],[126,17,88,22],[126,19,88,24],[126,24,88,29],[127,10,88,31,"error"],[127,15,88,36],[127,17,88,38],[128,8,88,67],[128,9,88,68],[129,6,89,4],[131,6,91,4],[132,6,92,4],[132,12,92,10,"restored"],[132,20,92,18],[132,23,92,21],[132,29,92,27],[132,33,92,27,"restoreAllData"],[132,46,92,41],[132,47,92,41,"restoreAllData"],[132,61,92,41],[132,63,92,42],[133,8,93,6,"sessions"],[133,16,93,14],[133,18,93,16,"backup"],[133,24,93,22],[133,25,93,23,"data"],[133,29,93,27],[133,30,93,28,"sessions"],[133,38,93,36],[133,42,93,40],[133,44,93,42],[134,8,94,6,"bows"],[134,12,94,10],[134,14,94,12,"backup"],[134,20,94,18],[134,21,94,19,"data"],[134,25,94,23],[134,26,94,24,"bows"],[134,30,94,28],[134,34,94,32],[135,6,95,4],[135,7,95,5],[135,8,95,6],[136,6,97,4],[136,10,97,8],[136,11,97,9,"restored"],[136,19,97,17],[136,21,97,19],[137,8,98,6],[137,15,98,13],[138,10,98,15,"success"],[138,17,98,22],[138,19,98,24],[138,24,98,29],[139,10,98,31,"error"],[139,15,98,36],[139,17,98,38],[140,8,98,63],[140,9,98,64],[141,6,99,4],[142,6,101,4],[142,13,101,11],[143,8,102,6,"success"],[143,15,102,13],[143,17,102,15],[143,21,102,19],[144,8,103,6,"sessionsCount"],[144,21,103,19],[144,23,103,21,"backup"],[144,29,103,27],[144,30,103,28,"data"],[144,34,103,32],[144,35,103,33,"sessions"],[144,43,103,41],[144,45,103,43,"length"],[144,51,103,49],[144,55,103,53],[144,56,103,54],[145,8,104,6,"bowsCount"],[145,17,104,15],[145,19,104,17,"backup"],[145,25,104,23],[145,26,104,24,"data"],[145,30,104,28],[145,31,104,29,"bows"],[145,35,104,33],[145,37,104,35,"length"],[145,43,104,41],[145,47,104,45],[146,6,105,4],[146,7,105,5],[147,4,106,2],[147,5,106,3],[147,6,106,4],[147,13,106,11,"error"],[147,18,106,16],[147,20,106,18],[148,6,107,4,"console"],[148,13,107,11],[148,14,107,12,"error"],[148,19,107,17],[148,20,107,18],[148,36,107,34],[148,38,107,36,"error"],[148,43,107,41],[148,44,107,42],[149,6,108,4],[149,13,108,11],[150,8,108,13,"success"],[150,15,108,20],[150,17,108,22],[150,22,108,27],[151,8,108,29,"error"],[151,13,108,34],[151,15,108,36,"error"],[151,20,108,41],[151,32,108,53,"Error"],[151,37,108,58],[151,40,108,61,"error"],[151,45,108,66],[151,46,108,67,"message"],[151,53,108,74],[151,56,108,77],[152,6,108,93],[152,7,108,94],[153,4,109,2],[154,2,110,0],[154,3,110,1],[155,0,110,2],[155,3]],"functionMap":{"names":["<global>","createBackup","restoreBackup"],"mappings":"AAA;4BCU;CD6C;6BEK;CFiD"},"hasCjsExports":false},"type":"js/module"}]}