{"dependencies":[{"name":"expo-file-system/src/legacy","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":58,"index":58}}],"key":"NnEInebZV3UkSvB64QlGf+rb+so=","exportNames":["*"],"imports":1}},{"name":"expo-sharing","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":59},"end":{"line":2,"column":40,"index":99}}],"key":"SUh687CeWkW0B+T6RbmrU/yQMvg=","exportNames":["*"],"imports":1}},{"name":"expo-document-picker","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":100},"end":{"line":3,"column":55,"index":155}}],"key":"NWjULt4J8GGUdXN68lY2F08+J7M=","exportNames":["*"],"imports":1}},{"name":"./localStorage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":156},"end":{"line":4,"column":79,"index":235}}],"key":"0SgXd320WtDFl1YmvtLMkksOAwg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"createBackup\", {\n    enumerable: true,\n    get: function () {\n      return createBackup;\n    }\n  });\n  Object.defineProperty(exports, \"restoreBackup\", {\n    enumerable: true,\n    get: function () {\n      return restoreBackup;\n    }\n  });\n  var _expoFileSystemSrcLegacy = require(_dependencyMap[0], \"expo-file-system/src/legacy\");\n  var FileSystem = _interopNamespace(_expoFileSystemSrcLegacy);\n  var _expoSharing = require(_dependencyMap[1], \"expo-sharing\");\n  var Sharing = _interopNamespace(_expoSharing);\n  var _expoDocumentPicker = require(_dependencyMap[2], \"expo-document-picker\");\n  var DocumentPicker = _interopNamespace(_expoDocumentPicker);\n  var _localStorage = require(_dependencyMap[3], \"./localStorage\");\n  /**\n   * Creates a backup of all data and opens the native share sheet\n   * User can save to Google Drive, email, or any other app\n   */\n  const createBackup = async () => {\n    try {\n      // Get all data from local storage\n      const data = await (0, _localStorage.getAllData)();\n\n      // Create backup object\n      const backup = {\n        version: '1.0',\n        exportedAt: new Date().toISOString(),\n        appName: 'Arrow Tracker',\n        data: {\n          sessions: data.sessions,\n          bows: data.bows\n        }\n      };\n\n      // Create file name with date\n      const dateStr = new Date().toISOString().split('T')[0];\n      const fileName = `arrow-tracker-backup-${dateStr}.json`;\n      const filePath = `${FileSystem.cacheDirectory}${fileName}`;\n\n      // Write to file\n      await FileSystem.writeAsStringAsync(filePath, JSON.stringify(backup, null, 2));\n\n      // Check if sharing is available\n      const sharingAvailable = await Sharing.isAvailableAsync();\n      if (!sharingAvailable) {\n        return {\n          success: false,\n          error: 'Sharing is not available on this device'\n        };\n      }\n\n      // Open native share sheet\n      await Sharing.shareAsync(filePath, {\n        mimeType: 'application/json',\n        dialogTitle: 'Save Arrow Tracker Backup',\n        UTI: 'public.json'\n      });\n\n      // Update last backup date\n      await (0, _localStorage.setLastBackupDate)();\n      return {\n        success: true\n      };\n    } catch (error) {\n      console.error('Backup error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      };\n    }\n  };\n\n  /**\n   * Opens file picker to select a backup file and restores the data\n   */\n  const restoreBackup = async () => {\n    try {\n      // Open file picker\n      const result = await DocumentPicker.getDocumentAsync({\n        type: 'application/json',\n        copyToCacheDirectory: true\n      });\n\n      // Check if user cancelled\n      if (result.canceled) {\n        return {\n          success: false,\n          canceled: true\n        };\n      }\n      const file = result.assets[0];\n\n      // Read file content\n      const content = await FileSystem.readAsStringAsync(file.uri);\n      const backup = JSON.parse(content);\n\n      // Validate backup format\n      if (!backup.data || !backup.data.sessions && !backup.data.bows) {\n        return {\n          success: false,\n          error: 'Invalid backup file format'\n        };\n      }\n\n      // Restore data\n      const restored = await (0, _localStorage.restoreAllData)({\n        sessions: backup.data.sessions || [],\n        bows: backup.data.bows || []\n      });\n      if (!restored) {\n        return {\n          success: false,\n          error: 'Failed to restore data'\n        };\n      }\n      return {\n        success: true,\n        sessionsCount: backup.data.sessions?.length || 0,\n        bowsCount: backup.data.bows?.length || 0\n      };\n    } catch (error) {\n      console.error('Restore error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      };\n    }\n  };\n});","lineCount":155,"map":[[22,2,10,0,"Object"],[22,8,10,0],[22,9,10,0,"defineProperty"],[22,23,10,0],[22,24,10,0,"exports"],[22,31,10,0],[23,4,10,0,"enumerable"],[23,14,10,0],[24,4,10,0,"get"],[24,7,10,0],[24,18,10,0,"get"],[24,19,10,0],[25,6,10,0],[25,13,10,0,"createBackup"],[25,25,10,0],[26,4,10,0],[27,2,10,0],[28,2,60,0,"Object"],[28,8,60,0],[28,9,60,0,"defineProperty"],[28,23,60,0],[28,24,60,0,"exports"],[28,31,60,0],[29,4,60,0,"enumerable"],[29,14,60,0],[30,4,60,0,"get"],[30,7,60,0],[30,18,60,0,"get"],[30,19,60,0],[31,6,60,0],[31,13,60,0,"restoreBackup"],[31,26,60,0],[32,4,60,0],[33,2,60,0],[34,2,1,0],[34,6,1,0,"_expoFileSystemSrcLegacy"],[34,30,1,0],[34,33,1,0,"require"],[34,40,1,0],[34,41,1,0,"_dependencyMap"],[34,55,1,0],[35,2,1,0],[35,6,1,0,"FileSystem"],[35,16,1,0],[35,19,1,0,"_interopNamespace"],[35,36,1,0],[35,37,1,0,"_expoFileSystemSrcLegacy"],[35,61,1,0],[36,2,2,0],[36,6,2,0,"_expoSharing"],[36,18,2,0],[36,21,2,0,"require"],[36,28,2,0],[36,29,2,0,"_dependencyMap"],[36,43,2,0],[37,2,2,0],[37,6,2,0,"Sharing"],[37,13,2,0],[37,16,2,0,"_interopNamespace"],[37,33,2,0],[37,34,2,0,"_expoSharing"],[37,46,2,0],[38,2,3,0],[38,6,3,0,"_expoDocumentPicker"],[38,25,3,0],[38,28,3,0,"require"],[38,35,3,0],[38,36,3,0,"_dependencyMap"],[38,50,3,0],[39,2,3,0],[39,6,3,0,"DocumentPicker"],[39,20,3,0],[39,23,3,0,"_interopNamespace"],[39,40,3,0],[39,41,3,0,"_expoDocumentPicker"],[39,60,3,0],[40,2,4,0],[40,6,4,0,"_localStorage"],[40,19,4,0],[40,22,4,0,"require"],[40,29,4,0],[40,30,4,0,"_dependencyMap"],[40,44,4,0],[41,2,6,0],[42,0,7,0],[43,0,8,0],[44,0,9,0],[45,2,10,7],[45,8,10,13,"createBackup"],[45,20,10,25],[45,23,10,28],[45,29,10,28,"createBackup"],[45,30,10,28],[45,35,10,87],[46,4,11,2],[46,8,11,6],[47,6,12,4],[48,6,13,4],[48,12,13,10,"data"],[48,16,13,14],[48,19,13,17],[48,25,13,23],[48,29,13,23,"getAllData"],[48,42,13,33],[48,43,13,33,"getAllData"],[48,53,13,33],[48,55,13,34],[48,56,13,35],[50,6,15,4],[51,6,16,4],[51,12,16,10,"backup"],[51,18,16,16],[51,21,16,19],[52,8,17,6,"version"],[52,15,17,13],[52,17,17,15],[52,22,17,20],[53,8,18,6,"exportedAt"],[53,18,18,16],[53,20,18,18],[53,24,18,22,"Date"],[53,28,18,26],[53,29,18,27],[53,30,18,28],[53,31,18,29,"toISOString"],[53,42,18,40],[53,43,18,41],[53,44,18,42],[54,8,19,6,"appName"],[54,15,19,13],[54,17,19,15],[54,32,19,30],[55,8,20,6,"data"],[55,12,20,10],[55,14,20,12],[56,10,21,8,"sessions"],[56,18,21,16],[56,20,21,18,"data"],[56,24,21,22],[56,25,21,23,"sessions"],[56,33,21,31],[57,10,22,8,"bows"],[57,14,22,12],[57,16,22,14,"data"],[57,20,22,18],[57,21,22,19,"bows"],[58,8,23,6],[59,6,24,4],[59,7,24,5],[61,6,26,4],[62,6,27,4],[62,12,27,10,"dateStr"],[62,19,27,17],[62,22,27,20],[62,26,27,24,"Date"],[62,30,27,28],[62,31,27,29],[62,32,27,30],[62,33,27,31,"toISOString"],[62,44,27,42],[62,45,27,43],[62,46,27,44],[62,47,27,45,"split"],[62,52,27,50],[62,53,27,51],[62,56,27,54],[62,57,27,55],[62,58,27,56],[62,59,27,57],[62,60,27,58],[63,6,28,4],[63,12,28,10,"fileName"],[63,20,28,18],[63,23,28,21],[63,47,28,45,"dateStr"],[63,54,28,52],[63,61,28,59],[64,6,29,4],[64,12,29,10,"filePath"],[64,20,29,18],[64,23,29,21],[64,26,29,24,"FileSystem"],[64,36,29,34],[64,37,29,35,"cacheDirectory"],[64,51,29,49],[64,54,29,52,"fileName"],[64,62,29,60],[64,64,29,62],[66,6,31,4],[67,6,32,4],[67,12,32,10,"FileSystem"],[67,22,32,20],[67,23,32,21,"writeAsStringAsync"],[67,41,32,39],[67,42,32,40,"filePath"],[67,50,32,48],[67,52,32,50,"JSON"],[67,56,32,54],[67,57,32,55,"stringify"],[67,66,32,64],[67,67,32,65,"backup"],[67,73,32,71],[67,75,32,73],[67,79,32,77],[67,81,32,79],[67,82,32,80],[67,83,32,81],[67,84,32,82],[69,6,34,4],[70,6,35,4],[70,12,35,10,"sharingAvailable"],[70,28,35,26],[70,31,35,29],[70,37,35,35,"Sharing"],[70,44,35,42],[70,45,35,43,"isAvailableAsync"],[70,61,35,59],[70,62,35,60],[70,63,35,61],[71,6,36,4],[71,10,36,8],[71,11,36,9,"sharingAvailable"],[71,27,36,25],[71,29,36,27],[72,8,37,6],[72,15,37,13],[73,10,37,15,"success"],[73,17,37,22],[73,19,37,24],[73,24,37,29],[74,10,37,31,"error"],[74,15,37,36],[74,17,37,38],[75,8,37,80],[75,9,37,81],[76,6,38,4],[78,6,40,4],[79,6,41,4],[79,12,41,10,"Sharing"],[79,19,41,17],[79,20,41,18,"shareAsync"],[79,30,41,28],[79,31,41,29,"filePath"],[79,39,41,37],[79,41,41,39],[80,8,42,6,"mimeType"],[80,16,42,14],[80,18,42,16],[80,36,42,34],[81,8,43,6,"dialogTitle"],[81,19,43,17],[81,21,43,19],[81,48,43,46],[82,8,44,6,"UTI"],[82,11,44,9],[82,13,44,11],[83,6,45,4],[83,7,45,5],[83,8,45,6],[85,6,47,4],[86,6,48,4],[86,12,48,10],[86,16,48,10,"setLastBackupDate"],[86,29,48,27],[86,30,48,27,"setLastBackupDate"],[86,47,48,27],[86,49,48,28],[86,50,48,29],[87,6,50,4],[87,13,50,11],[88,8,50,13,"success"],[88,15,50,20],[88,17,50,22],[89,6,50,27],[89,7,50,28],[90,4,51,2],[90,5,51,3],[90,6,51,4],[90,13,51,11,"error"],[90,18,51,16],[90,20,51,18],[91,6,52,4,"console"],[91,13,52,11],[91,14,52,12,"error"],[91,19,52,17],[91,20,52,18],[91,35,52,33],[91,37,52,35,"error"],[91,42,52,40],[91,43,52,41],[92,6,53,4],[92,13,53,11],[93,8,53,13,"success"],[93,15,53,20],[93,17,53,22],[93,22,53,27],[94,8,53,29,"error"],[94,13,53,34],[94,15,53,36,"error"],[94,20,53,41],[94,32,53,53,"Error"],[94,37,53,58],[94,40,53,61,"error"],[94,45,53,66],[94,46,53,67,"message"],[94,53,53,74],[94,56,53,77],[95,6,53,93],[95,7,53,94],[96,4,54,2],[97,2,55,0],[97,3,55,1],[99,2,57,0],[100,0,58,0],[101,0,59,0],[102,2,60,7],[102,8,60,13,"restoreBackup"],[102,21,60,26],[102,24,60,29],[102,30,60,29,"restoreBackup"],[102,31,60,29],[102,36,66,6],[103,4,67,2],[103,8,67,6],[104,6,68,4],[105,6,69,4],[105,12,69,10,"result"],[105,18,69,16],[105,21,69,19],[105,27,69,25,"DocumentPicker"],[105,41,69,39],[105,42,69,40,"getDocumentAsync"],[105,58,69,56],[105,59,69,57],[106,8,70,6,"type"],[106,12,70,10],[106,14,70,12],[106,32,70,30],[107,8,71,6,"copyToCacheDirectory"],[107,28,71,26],[107,30,71,28],[108,6,72,4],[108,7,72,5],[108,8,72,6],[110,6,74,4],[111,6,75,4],[111,10,75,8,"result"],[111,16,75,14],[111,17,75,15,"canceled"],[111,25,75,23],[111,27,75,25],[112,8,76,6],[112,15,76,13],[113,10,76,15,"success"],[113,17,76,22],[113,19,76,24],[113,24,76,29],[114,10,76,31,"canceled"],[114,18,76,39],[114,20,76,41],[115,8,76,46],[115,9,76,47],[116,6,77,4],[117,6,79,4],[117,12,79,10,"file"],[117,16,79,14],[117,19,79,17,"result"],[117,25,79,23],[117,26,79,24,"assets"],[117,32,79,30],[117,33,79,31],[117,34,79,32],[117,35,79,33],[119,6,81,4],[120,6,82,4],[120,12,82,10,"content"],[120,19,82,17],[120,22,82,20],[120,28,82,26,"FileSystem"],[120,38,82,36],[120,39,82,37,"readAsStringAsync"],[120,56,82,54],[120,57,82,55,"file"],[120,61,82,59],[120,62,82,60,"uri"],[120,65,82,63],[120,66,82,64],[121,6,83,4],[121,12,83,10,"backup"],[121,18,83,16],[121,21,83,19,"JSON"],[121,25,83,23],[121,26,83,24,"parse"],[121,31,83,29],[121,32,83,30,"content"],[121,39,83,37],[121,40,83,38],[123,6,85,4],[124,6,86,4],[124,10,86,8],[124,11,86,9,"backup"],[124,17,86,15],[124,18,86,16,"data"],[124,22,86,20],[124,26,86,25],[124,27,86,26,"backup"],[124,33,86,32],[124,34,86,33,"data"],[124,38,86,37],[124,39,86,38,"sessions"],[124,47,86,46],[124,51,86,50],[124,52,86,51,"backup"],[124,58,86,57],[124,59,86,58,"data"],[124,63,86,62],[124,64,86,63,"bows"],[124,68,86,68],[124,70,86,70],[125,8,87,6],[125,15,87,13],[126,10,87,15,"success"],[126,17,87,22],[126,19,87,24],[126,24,87,29],[127,10,87,31,"error"],[127,15,87,36],[127,17,87,38],[128,8,87,67],[128,9,87,68],[129,6,88,4],[131,6,90,4],[132,6,91,4],[132,12,91,10,"restored"],[132,20,91,18],[132,23,91,21],[132,29,91,27],[132,33,91,27,"restoreAllData"],[132,46,91,41],[132,47,91,41,"restoreAllData"],[132,61,91,41],[132,63,91,42],[133,8,92,6,"sessions"],[133,16,92,14],[133,18,92,16,"backup"],[133,24,92,22],[133,25,92,23,"data"],[133,29,92,27],[133,30,92,28,"sessions"],[133,38,92,36],[133,42,92,40],[133,44,92,42],[134,8,93,6,"bows"],[134,12,93,10],[134,14,93,12,"backup"],[134,20,93,18],[134,21,93,19,"data"],[134,25,93,23],[134,26,93,24,"bows"],[134,30,93,28],[134,34,93,32],[135,6,94,4],[135,7,94,5],[135,8,94,6],[136,6,96,4],[136,10,96,8],[136,11,96,9,"restored"],[136,19,96,17],[136,21,96,19],[137,8,97,6],[137,15,97,13],[138,10,97,15,"success"],[138,17,97,22],[138,19,97,24],[138,24,97,29],[139,10,97,31,"error"],[139,15,97,36],[139,17,97,38],[140,8,97,63],[140,9,97,64],[141,6,98,4],[142,6,100,4],[142,13,100,11],[143,8,101,6,"success"],[143,15,101,13],[143,17,101,15],[143,21,101,19],[144,8,102,6,"sessionsCount"],[144,21,102,19],[144,23,102,21,"backup"],[144,29,102,27],[144,30,102,28,"data"],[144,34,102,32],[144,35,102,33,"sessions"],[144,43,102,41],[144,45,102,43,"length"],[144,51,102,49],[144,55,102,53],[144,56,102,54],[145,8,103,6,"bowsCount"],[145,17,103,15],[145,19,103,17,"backup"],[145,25,103,23],[145,26,103,24,"data"],[145,30,103,28],[145,31,103,29,"bows"],[145,35,103,33],[145,37,103,35,"length"],[145,43,103,41],[145,47,103,45],[146,6,104,4],[146,7,104,5],[147,4,105,2],[147,5,105,3],[147,6,105,4],[147,13,105,11,"error"],[147,18,105,16],[147,20,105,18],[148,6,106,4,"console"],[148,13,106,11],[148,14,106,12,"error"],[148,19,106,17],[148,20,106,18],[148,36,106,34],[148,38,106,36,"error"],[148,43,106,41],[148,44,106,42],[149,6,107,4],[149,13,107,11],[150,8,107,13,"success"],[150,15,107,20],[150,17,107,22],[150,22,107,27],[151,8,107,29,"error"],[151,13,107,34],[151,15,107,36,"error"],[151,20,107,41],[151,32,107,53,"Error"],[151,37,107,58],[151,40,107,61,"error"],[151,45,107,66],[151,46,107,67,"message"],[151,53,107,74],[151,56,107,77],[152,6,107,93],[152,7,107,94],[153,4,108,2],[154,2,109,0],[154,3,109,1],[155,0,109,2],[155,3]],"functionMap":{"names":["<global>","createBackup","restoreBackup"],"mappings":"AAA;4BCS;CD6C;6BEK;CFiD"},"hasCjsExports":false},"type":"js/module"}]}